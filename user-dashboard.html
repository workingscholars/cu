<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WSA CyberAccount</title>
    <link rel="icon" href="assets/logo/wsa.png" type="image/x-icon" />
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
    :root {
        --crimson-primary: #990000;
        --crimson-secondary: #6F0000;
        --crimson-light: #D32F2F;
    }

    body {
        background-color: #f4f6f9;
        padding-top: 100px; /* Adjust based on navbar height */
    }

    .nav-menu::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(153, 0, 0, 0.3); /* Crimson red overlay with transparency */
        z-index: 1;
        pointer-events: none; /* Ensure it doesn't interfere with interactions */
    }

    .nav-menu {
            background-color: var(--crimson-light);
            padding: 10px 0;
            z-index: 1000;
    }

    .nav-logo {
        max-height: 50px;
        max-width: 100px;
        object-fit: contain;
    }

    .nav-menu .nav-links a {
        color: white;
        margin: 0 10px;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .nav-menu .nav-links a:hover {
        color: #FFD700;
        transform: scale(1.1);
    }

    .nav-links {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 20px;
    }

    .nav-links a {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: white;
        transition: all 0.3s ease;
    }

    .profile-section {
        border: 2px solid var(--crimson-primary);
        border-radius: 10px;
        padding: 20px;
        margin-top: 20px;
    }

    .nav-links a.active .nav-icon-circle {
        background-color: rgba(255,255,255,0.3);
        transform: scale(1.1);
    }

    .nav-links a.active span {
        font-weight: bold;
    }

    .section-header {
        background-color: var(--crimson-primary);
        color: white;
        padding: 10px;
        border-radius: 5px 5px 0 0;
    }

    /* Section Content Styling */
    .section-content {
        display: none;
        padding: 20px;
        animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    /* Logout Icon Styling */
    .logout-link {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-decoration: none;
        color: white;
        transition: all 0.3s ease;
    }

    .logout-circle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: transparent;
        transition: all 0.3s ease;
        margin-bottom: 5px;
    }

    .logout-link:hover .logout-circle {
        background-color: rgba(255,255,255,0.2);
        transform: scale(1.1);
    }

    .logout-text {
        font-size: 0.8em;
        color: white;
    }

    /* Ensure logout icon is visible and styled consistently */
    .nav-menu .logout-link {
        color: white;
    }

    .nav-menu .logout-circle i {
        color: white;
    }

    /* Ensure obligations are properly placed */
    #obligations {
        display: none;
    }

        .profile-image-container {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
    }

    .profile-image-container img {
        max-width: 200px;
        max-height: 200px;
        width: 200px;
        height: 200px;
        object-fit: cover;
        object-position: center;
        border: 4px solid var(--crimson-primary);
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .info-section {
        border: 1px solid #ddd;
        margin-top: 20px;
        border-radius: 5px;
    }

    /* New Grades Section Styles */
    .dashboard-container {
        background-color: white;
        border-radius: 15px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        margin-top: 50px;
        overflow: hidden;
    }

    .dashboard-header {
        background-color: var(--crimson-primary);
        color: white;
        padding: 20px;
        text-align: center;
    }

    .average-grade-card {
        background-color: var(--crimson-light);
        color: white;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
        border-radius: 10px;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(211, 47, 47, 0.1);
        cursor: pointer;
    }

    .grade-badge {
        font-size: 0.9em;
        font-weight: bold;
    }

    .progress {
        height: 20px;
        margin-top: 10px;
    }

    .card-header {
        background-color: var(--crimson-secondary);
        color: white;
    }

    .nav-links {
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative; /* Ensure proper positioning */
    }

    .nav-icon-circle {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: transparent;
        transition: all 0.3s ease;
        margin-bottom: 5px;
    }

    .nav-links a:hover .nav-icon-circle {
        background-color: rgba(255,255,255,0.2);
        transform: scale(1.1);
    }

    .nav-links a span {
        font-size: 0.8em;
    }


    .downloadable-area {
    border: 1px solid #dee2e6;
    background-color: #f8f9fa;
    width: 100%;
    align-items: center;
    }

    .student-info, .semester-info {
        font-size: 0.9rem;
    }

    .approval-info {
        font-size: 0.85rem;
        color: #6c757d;
    }

    /* Spinning animation for refresh button */
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .fa-spin {
        animation: spin 1s linear infinite;
    }

        /* Obligations Section Styling */
    .obligations-container {
        max-width: 800px; /* Adjust base width */
        margin: 0 auto; /* Center the container */
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    .downloadable-area {
        max-width: 300px; /* Adjust permit area width */
        margin: 0 auto;
        background-color: white;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .obligations-container {
            max-width: 95%;
            padding: 10px;
        }

        .downloadable-area {
            max-width: 100%;
            padding: 15px;
        }

        .semester-term-selectors {
            flex-direction: column;
        }

        .semester-term-selectors > div {
            margin-bottom: 10px;
        }
    }

    /* Selector and Refresh Area */
    .semester-term-selectors {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .selector-group {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .selector-group label {
        font-weight: 600;
        white-space: nowrap;
    }

    .download-icon {
        transition: transform 0.2s ease;
    }

    .download-icon:hover {
        transform: scale(1.1);
        color: var(--crimson-primary);
    }
</style>
</head>
<body>

<!-- Navigation Menu -->
<div class="nav-menu fixed-top">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-2">
                <!-- Logo placement -->
                <img src="assets/logo/wsa.png" alt="WSA Logo" class="nav-logo">
            </div>
            <div class="col-10">
                <div class="nav-links text-center">
                    <a href="#profile" data-section="profile">
                        <div class="nav-icon-circle">
                            <i class="fas fa-user"></i>
                        </div>
                        <span>Profile</span>
                    </a>
                    <a href="#grades" data-section="grades">
                        <div class="nav-icon-circle">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <span>Grades</span>
                    </a>
                    <a href="#ledger" data-section="ledger">
                        <div class="nav-icon-circle">
                            <i class="fas fa-book"></i>
                        </div>
                        <span>Student Ledger</span>
                    </a>
                    <a href="#obligations" data-section="obligations">
                        <div class="nav-icon-circle">
                            <i class="fas fa-clipboard-list"></i>
                        </div>
                        <span>Obligations</span>
                    </a>
                    <a href="#studyloads" data-section="studyloads">
                        <div class="nav-icon-circle">
                            <i class="fas fa-clipboard-list"></i>
                        </div>
                        <span>Study Loads</span>
                    </a>
                    <a href="#" class="logout-link" data-bs-toggle="modal" data-bs-target="#logoutModal">
                    <div class="nav-icon-circle logout-circle">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                    <span class="logout-text">Logout</span>
                </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container mt-4">
    <!-- Profile Section -->
    <div id="profile" class="section-content">
        <div class="row profile-section">
            <div class="col-md-4 text-center">
                <div class="profile-image-container mb-3">
                    <img src="assets/user-profile/Jcrist.jpg" class="rounded-circle" alt="Profile Picture" style="width: 200px; height: 200px; object-fit: cover; object-position: center;">
                </div>
                <h4>Jcrist Vincent Orhen</h4>
                <p>2090389</p>
                <p>BSIT-1</p>
            </div>
                <div class="col-md-8">
                    <div class="info-section">
                        <div class="section-header">Personal Information</div>
                        <div class="p-3">
                            <p><i class="fas fa-birthday-cake"></i> Birthday: 10 Feb 2005</p>
                            <p><i class="fas fa-map-marker-alt"></i> Location: Tion Street, North Poblacion, Medina, Misamis Oriental</p>
                            <p><i class="fas fa-envelope"></i> Email: orhenjcrist@gmail.com</p>
                            <p><i class="fas fa-phone"></i> Phone: 09627972598</p>
                            <p><i class="fas fa-venus-mars"></i> Gender: Male</p>
                            <p><i class="fas fa-heart"></i> Status: Single</p>
                            <p><i class="fas fa-globe"></i> Nationality: Filipino</p>
                        </div>
                    </div>

                    <div class="info-section mt-3">
                        <div class="section-header">Relatives Information</div>
                        <div class="p-3">
                            <p>Father's Name: Cresanto Callao Gerundio</p>
                            <p>Mother's Name: Jonesa Rose Orhen</p>
                            <p>Guardian's Name: N / A</p>
                            <p>Spouse Name: N / A</p>
                        </div>
                    </div>

                    <div class="info-section mt-3">
                        <div class="section-header">Education Information</div>
                        <div class="p-3">
                            <p>Primary: St. Isidore School</p>
                            <p>Secondary (Junior): St. Isidore School</p>
                            <p>Secondary (Senior): Medina National Comprehensive High School 2024</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Grades Section -->
            <div id="grades" class="section-content" style="display:none;">

            <!-- Average Grade Section -->
            <div class="container mt-4">
                <div class="row">
                    <div class="col-md-8 offset-md-2">
                        <div class="average-grade-card">
                            <h3>AVERAGE FINAL GRADE</h3>
                            <h1 id="finalAverage" class="display-4">0.00</h1>
                            <div class="progress">
                                <div id="gradeProgress" class="progress-bar bg-warning" role="progressbar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Grades Table -->
            <div class="container mb-4">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="fas fa-table me-2"></i>Detailed Grades</h4>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="gradesTable">
                                <thead class="table-danger">
                                    <tr>
                                        <th>SUBJECTS</th>
                                        <th>PRELIM</th>
                                        <th>MIDTERM</th>
                                        <th>FINALS</th>
                                        <th>STATUS</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>INTRO TO COMPUTING</td>
                                        <td>1.50</td>
                                        <td>1.25</td>
                                        <td>1.00</td>
                                        <td><span class="badge bg-success grade-badge">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td>INTRO TO PROGRAMMING</td>
                                        <td>1.25</td>
                                        <td>1.25</td>
                                        <td>1.00</td>
                                        <td><span class="badge bg-success grade-badge">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td>PROGRAM LOGIC FORMULATION</td>
                                        <td>1.20</td>
                                        <td>1.50</td>
                                        <td>1.75</td>
                                        <td><span class="badge bg-success grade-badge">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td>GENERAL ORIENTATION</td>
                                        <td>1.00</td>
                                        <td>1.00</td>
                                        <td>1.00</td>
                                        <td><span class="badge bg-success grade-badge">PASSED</span></td>
                                    </tr>
                                    <tr>
                                        <td>ORIENTATION TO IT CAREERS</td>
                                        <td>1.20</td>
                                        <td>1.20</td>
                                        <td>1.10</td>
                                        <td><span class="badge bg-success grade-badge">PASSED</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- Student Ledger Section -->
        <div id="ledger" class="section-content" style="display:none;">
            <div class="card">
                <div class="card-header bg-danger text-white">Student Ledger</div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Receipt Number</th>
                                    <th>Charges</th>
                                    <th>Payments</th>
                                    <th>Reference</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Oct 17, 2024</td>
                                    <td>Working Scholar Discount</td>
                                    <td></td>
                                    <td>₱ 0.00</td>
                                    <td>₱ 25,127.63</td>
                                    <td>CU Working Scholar</td>
                                </tr>
                                <!-- Add other ledger entries here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Obligations Section -->
<div id="obligations" class="section-content" style="display:none;">
        <div class="obligations-container">
            <div class="accordion" id="obligationsAccordion">
                <!-- Your existing obligations content -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#permits">
                            Permits
                        </button>
                    </h2>
                    <div id="permits" class="accordion-collapse collapse show">
                        <!-- Permits content -->
                <div class="accordion-body">
                    <!-- Semester and Term Selectors -->
                    <div class="semester-term-selectors">
                        <div class="selector-group">
                            <label>Semester:</label>
                            <select class="form-select form-select-sm" id="semesterSelector">
                                <option>First Semester SY 2024-2025</option>
                            </select>
                        </div>
                        
                        <div class="selector-group">
                            <label>Term:</label>
                            <select class="form-select form-select-sm" id="termSelector">
                                <option>PRELIM</option>
                                <option>MIDTERM</option>
                                <option>FINALS</option>
                            </select>
                        </div>
                        
                        <div>
                            <button class="btn btn-outline-secondary btn-sm" id="refreshPermits">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>

                    <!-- Downloadable Permit Area -->
                    <div class="downloadable-area mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">Exam Permit</h5>
                            <button id="downloadPermit" class="btn btn-link text-secondary download-icon" title="Download Permit">
                                <i class="fas fa-circle-arrow-down fa-2x"></i>
                            </button>
                        </div>

                        <div class="permit-details">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="student-info">
                                        <div>Orhen, Jcrist Vincent</div>
                                        <div>2090389</div>
                                    </div>
                                </div>
                                <div class="col-md-6 text-end">
                                    <div class="semester-info">
                                        <div>First Semester SY 2024-2025</div>
                                        <div>MIDTERM</div>
                                    </div>
                                </div>
                            </div>

                            <div class="text-center mb-4">
                                <div class="text-success">
                                    <i class="fas fa-circle-check fa-7x"></i>
                                    <div class="mt-2">
                                        <strong>Allowed to take exam</strong>
                                    </div>
                                </div>
                            </div>

                            <div class="approval-info text-center">
                                <div>
                                    <span>Approved by: </span>
                                    <span class="fw-bold">gamaya.nanette</span>
                                </div>
                                <div>
                                    <span>Approved on: </span>
                                    <span class="fw-bold">Oct 26, 2024</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


                        <div class="modal fade" id="downloadConfirmModal" tabindex="-1">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header bg-success text-white">
                                        <h5 class="modal-title">Receipt Downloaded</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body text-center">
                                        <i class="fas fa-file-download fa-4x text-success mb-3"></i>
                                        <h4>Download Successful</h4>
                                        <p>Your receipt has been downloaded as 2090389.jpg</p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#clearances">
                                    Clearances
                                </button>
                            </h2>
                            <div id="clearances" class="accordion-collapse collapse">
                                <div class="accordion-body">
                                    Content related to clearances will be displayed here.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#billings">
                                    Billings
                                </button>
                            </h2>
                            <div id="billings" class="accordion-collapse collapse">
                                <div class="accordion-body">
                                    Content related to billings will be displayed here.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#duties">
                                    Duties
                                </button>
                            </h2>
                            <div id="duties" class="accordion-collapse collapse">
                                <div class="accordion-body">
                                    Content related to duties will be displayed here.
                                </div>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#cls">
                                    CL's
                                </button>
                            </h2>
                            <div id="cls" class="accordion-collapse collapse">
                                <div class="accordion-body">
                                    Content related to CL's will be displayed here.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Study Loads Section -->
<div id="studyloads" class="section-content" style="display:none;">
    <div class="card">
        <div class="card-header bg-danger text-white d-flex justify-content-between align-items-center">
            <span></span>
            <div class="d-flex align-items-center">
                <div class="me-3">
                    <select class="form-select form-select-sm" id="semesterSelector">
                        <option>FIRST SEM SY 2024-2025</option>
                    </select>
                </div>
                <button class="btn btn-light btn-sm" id="refreshStudyLoads" title="Refresh Study Loads">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
        </div>
        <div class="card-body">
            <div class="row mb-3">
                <div class="col-md-4">
                    <p class="mb-1"><strong>Enrollment Status:</strong> ENROLLED</p>
                </div>
                <div class="col-md-4">
                    <p class="mb-1"><strong>Semester Total Units:</strong> 15 unit(s)</p>
                </div>
            </div>

            <table id="study-loads-table" class="table table-striped table-hover">
                <thead class="table-danger">
                    <tr>
                        <th>Section Code</th>
                        <th>Subject</th>
                        <th>Description</th>
                        <th>Units</th>
                        <th>Time</th>
                        <th>Day</th>
                        <th>Room</th>
                        <th>Block Code</th>
                        <th>Instructor</th>
                    </tr>
                </thead>
                <tbody>
                                                <tr>
                                <td>IT1</td>
                                <td>ORIENT 1</td>
                                <td>GENERAL ORIENTATION</td>
                                <td>1</td>
                                <td>08:30AM-09:30AM</td>
                                <td>M</td>
                                <td>323</td>
                                <td>1A</td>
                                <td>CYRIL JANE COCA RANIDO</td>
                            </tr>
                            <tr>
                                <td>IT6</td>
                                <td>CompSci 4</td>
                                <td>Introduction to Programming (Other Sched.)</td>
                                <td>3</td>
                                <td>10:00AM-12:00PM</td>
                                <td>M</td>
                                <td>IncuRmCS</td>
                                <td>1A</td>
                                <td>CHRISTIAN JADE N. NALAGON</td>
                            </tr>
                            <tr>
                                <td>IT5</td>
                                <td>IT 101</td>
                                <td>PROGRAM LOGIC FORMULATION</td>
                                <td>3</td>
                                <td>10:00AM-12:00PM</td>
                                <td>TueThu</td>
                                <td>323</td>
                                <td>1A</td>
                                <td>CHRISTIAN JADE N. NALAGON</td>
                            </tr>
                            <tr>
                                <td>IT6</td>
                                <td>CompSci 4</td>
                                <td>Introduction to Programming</td>
                                <td>3</td>
                                <td>03:00PM-04:30PM</td>
                                <td>TueThu</td>
                                <td>CL-A</td>
                                <td>1A</td>
                                <td>CHRISTIAN JADE N. NALAGON</td>
                            </tr>
                            <tr>
                                <td>IT3</td>
                                <td>IT 102</td>
                                <td>Introduction to Computing</td>
                                <td>3</td>
                                <td>10:00AM-12:00PM</td>
                                <td>W</td>
                                <td>323</td>
                                <td>1A</td>
                                <td>MILO SALDON CAGANDAHAN</td>
                            </tr>
                            <tr>
                                <td>IT3</td>
                                <td>IT 102</td>
                                <td>Introduction to Computing (Other Sched.)</td>
                                <td>3</td>
                                <td>10:00AM-12:00PM</td>
                                <td>W</td>
                                <td>CL-A</td>
                                <td>1A</td>
                                <td>MILO SALDON CAGANDAHAN</td>
                            </tr>
                            <tr>
                                <td>IT2</td>
                                <td>IT 100</td>
                                <td>Orientation to IT Careers</td>
                                <td>1</td>
                                <td>08:00AM-09:00AM</td>
                                <td>F</td>
                                <td>323</td>
                                <td>1A</td>
                                <td>CYRIL JANE COCA RANIDO</td>
                            </tr>
                            <tr>
                                <td>IT4</td>
                                <td>IT 103</td>
                                <td>IT Project 1</td>
                                <td>1</td>
                                <td>09:30AM-10:30AM</td>
                                <td>F</td>
                                <td>323</td>
                                <td>1A</td>
                                <td>CHRISTIAN JADE N. NALAGON</td>
                            </tr>
                            <tr>
                                <td>WS3</td>
                                <td>NSTP 1</td>
                                <td>National Service Training Program 1</td>
                                <td>3</td>
                                <td>09:00AM-12:00PM</td>
                                <td>Sat</td>
                                <td>WS/SF</td>
                                <td>WSA/SF</td>
                                <td>AMOR YAMOMO MENDOZA</td>
                            </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

 <!-- Add this just before the closing </body> tag -->
<!-- Logout Modal -->
<div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title" id="logoutModalLabel">Logout Confirmation</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center">
                    <i class="fas fa-sign-out-alt fa-4x text-danger mb-3"></i>
                    <h4>Are you sure you want to logout?</h4>
                    <p>Your current session will be terminated.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmLogout">Logout</button>
            </div>
        </div>
    </div>
</div>

<!-- Modify the existing script section to include logout functionality -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script>
        // Call the function when page loads
        window.onload = calculateFinalAverage;
document.addEventListener('DOMContentLoaded', function() {
    // Navigation menu click handler
    document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Remove active state from all links
            document.querySelectorAll('.nav-links a').forEach(navLink => {
                navLink.classList.remove('active');
            });
            
            // Add active state to clicked link
            this.classList.add('active');
            
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            const target = this.getAttribute('data-section');
            const targetSection = document.getElementById(target);
            
            if (targetSection) {
                targetSection.style.display = 'block';
            }
        });
    });

    // Initially show profile section and set its menu item as active
    document.getElementById('profile').style.display = 'block';
    document.querySelector('a[data-section="profile"]').classList.add('active');
});

        // Confirm logout button
        document.getElementById('confirmLogout').addEventListener('click', function() {
            // Performing log out actions
            localStorage.clear();
            sessionStorage.clear();
            
            // Redirect to login page (replace with your actual login page URL)
            window.location.href = 'index.html';
        });

    // Calculate Grades
    function calculateFinalAverage() {
            const finalGrades = [1.00, 1.00, 1.75, 1.00, 1.10];
            const average = finalGrades.reduce((a, b) => a + b, 0) / finalGrades.length;
            
            // Update average display
            const averageElement = document.getElementById('finalAverage');
            averageElement.textContent = average.toFixed(2);

            // Update progress bar
            const progressBar = document.getElementById('gradeProgress');
            const progressPercentage = (4.0 - average) / 4.0 * 100;
            progressBar.style.width = `${progressPercentage}%`;
        }

        // Add hover effects to table rows
        const tableRows = document.querySelectorAll('#gradesTable tbody tr');
        tableRows.forEach(row => {
            row.addEventListener('mouseenter', () => {
                row.classList.add('table-active');
            });
            row.addEventListener('mouseleave', () => {
                row.classList.remove('table-active');
            });
        });

        window.addEventListener('scroll', function() {
    const navMenu = document.querySelector('.nav-menu');
    if (window.scrollY > 50) {
        navMenu.classList.add('sticky');
    } else {
        navMenu.classList.remove('sticky');
    }
});

document.addEventListener('DOMContentLoaded', function() {
    // Semester Selector Functionality
    const semesterSelector = document.getElementById('semesterSelector');
    const refreshButton = document.getElementById('refreshStudyLoads');

    semesterSelector.addEventListener('change', function() {
        // Add functionality to load study loads for selected semester
        console.log('Selected Semester:', this.value);
        // You can add AJAX call here to fetch semester-specific study loads
    });

    refreshButton.addEventListener('click', function() {
        // Add refresh functionality
        console.log('Refreshing study loads for:', semesterSelector.value);
        
        // Optional: Add loading animation
        this.classList.add('spinning');
        
        // Simulate refresh (replace with actual data fetch)
        setTimeout(() => {
            this.classList.remove('spinning');
            // Add your refresh logic here
        }, 1000);
    });
});

document.addEventListener('DOMContentLoaded', function() {
    const semesterSelector = document.getElementById('semesterSelector');
    const refreshButton = document.getElementById('refreshPermits');
    const downloadButton = document.getElementById('downloadPermit');
});

document.addEventListener('DOMContentLoaded', function() {
    const termSelector = document.getElementById('termSelector');
    
    // Permit data object
    const permitData = {
        'PRELIM': {
            term: 'PRELIM',
            approvedBy: 'gamaya.nanette',
            approvedOn: 'Sep 14, 2024',
            status: 'Allowed to take exam'
        },
        'MIDTERM': {
            term: 'MIDTERM',
            approvedBy: 'gamaya.nanette',
            approvedOn: 'Oct 11, 2024',
            status: 'Allowed to take exam'
        },
        'FINALS': {
            term: 'FINALS',
            approvedBy: 'gamaya.nanette',
            approvedOn: 'Nov 28, 2024',
            status: 'Allowed to take exam'
        }
    };

    // Function to update permit details
    function updatePermitDetails(term) {
        const permitDetails = permitData[term];
        
        // Update semester info
        document.querySelector('.semester-info').innerHTML = `
            <div>First Semester SY 2024-2025</div>
            <div>${permitDetails.term}</div>
        `;

        // Update approval info
        document.querySelector('.approval-info').innerHTML = `
            <div>
                <span>Approved by: </span>
                <span class="fw-bold">${permitDetails.approvedBy}</span>
            </div>
            <div>
                <span>Approved on: </span>
                <span class="fw-bold">${permitDetails.approvedOn}</span>
            </div>
        `;

        // Update status icon and text
        const statusContainer = document.querySelector('.text-center.mb-4');
        statusContainer.innerHTML = `
            <div class="text-success">
                <i class="fas fa-circle-check fa-7x"></i>
                <div class="mt-2">
                    <strong>${permitDetails.status}</strong>
                </div>
            </div>
        `;
    }

    // Initial load
    updatePermitDetails(termSelector.value);

    // Add event listener for term selector changes
    termSelector.addEventListener('change', function() {
        updatePermitDetails(this.value);
    });
});

// More robust download handler
function downloadReceipt(studentId) {
    try {
        const permitArea = document.querySelector('.downloadable-area');
        
        html2canvas(permitArea, {
            scale: 3, // Even higher resolution
            useCORS: true,
            backgroundColor: '#ffffff'
        }).then(canvas => {
            // Compress and optimize image
            const imgData = canvas.toDataURL('image/jpeg', 0.8);
            
            const link = document.createElement('a');
            link.download = `${studentId}_permit.jpg`;
            link.href = imgData;
            
            // Trigger download
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            // Log download event (optional)
            logDownload(studentId);
            
            // Show confirmation
            showDownloadConfirmation();
        });
    } catch (error) {
        console.error('Download failed:', error);
        alert('Download failed. Please try again.');
    }
}

// Optional: Logging function (implement with your backend)
function logDownload(studentId) {
    fetch('/log-download', {
        method: 'POST',
        body: JSON.stringify({ 
            studentId: studentId,
            documentType: 'permit',
            timestamp: new Date().toISOString()
        }),
        headers: {
            'Content-Type': 'application/json'
        }
    });
}

    // Optional: Show confirmation modal after download
    function showDownloadConfirmation() {
        const downloadConfirmModal = new bootstrap.Modal(document.getElementById('downloadConfirmModal'));
        downloadConfirmModal.show();
    }

    document.addEventListener('DOMContentLoaded', function() {
    const downloadButton = document.getElementById('downloadPermit');
    
    downloadButton.addEventListener('click', function() {
        // Clone the permit area, removing the download button
        const permitArea = document.querySelector('.downloadable-area');
        const clonedArea = permitArea.cloneNode(true);
        
        // Remove download button from cloned area
        const clonedDownloadButton = clonedArea.querySelector('#downloadPermit');
        if (clonedDownloadButton) {
            clonedDownloadButton.remove();
        }
        
        // Create a temporary container to hold the cloned area
        const tempContainer = document.createElement('div');
        tempContainer.style.position = 'absolute';
        tempContainer.style.left = '-9999px';
        tempContainer.appendChild(clonedArea);
        document.body.appendChild(tempContainer);
        
        // Capture the cloned area
        html2canvas(clonedArea, {
            scale: 2,
            useCORS: true,
            backgroundColor: '#ffffff'
        }).then(canvas => {
            // Create download link
            const link = document.createElement('a');
            const studentId = '2090389';
            
            link.download = `${studentId}_permit.jpg`;
            link.href = canvas.toDataURL('image/jpeg');
            
            // Trigger download
            link.click();
            
            // Remove temporary container
            document.body.removeChild(tempContainer);
        }).catch(error => {
            console.error('Error downloading receipt:', error);
            alert('Failed to download receipt. Please try again.');
            
            // Remove temporary container if error occurs
            if (document.body.contains(tempContainer)) {
                document.body.removeChild(tempContainer);
            }
        });
    });
});
</script>
